```mermaid
graph TB
    subgraph External["ğŸŒ EXTERNAL SYSTEMS"]
        EL[ElevenLabs API]
        UI[Frontend UI / Dashboard]
    end

    subgraph Layer3["ğŸ“± LAYER 3: UI DATA MODELS (Presentation Layer)"]
        direction TB
        L3_Models["<b>UI Models (TypeScript)</b><br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>â€¢ UserDashboard<br/>â€¢ ConversationSummary<br/>â€¢ ConversationDetail<br/>â€¢ MemorySummary<br/>â€¢ MemoryDetail<br/>â€¢ MemoryGraph<br/>â€¢ PerformanceMetrics<br/>â€¢ MemoryAnalytics"]

        L3_Purpose["<b>Purpose:</b><br/>â€¢ Simplified, denormalized views<br/>â€¢ Pre-aggregated data<br/>â€¢ Optimized for rendering<br/>â€¢ Frontend-friendly formats"]

        L3_Transforms["<b>Transformations:</b><br/>â€¢ Flatten nested objects<br/>â€¢ Aggregate statistics<br/>â€¢ Format timestamps (ISO 8601)<br/>â€¢ Calculate derived metrics<br/>â€¢ Pre-join related data"]
    end

    subgraph Layer2["âš™ï¸ LAYER 2: SERVICE MODELS (Business Logic Layer)"]
        direction TB
        L2_Models["<b>Domain Models (Python/Pydantic)</b><br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>â€¢ WebhookEvent<br/>â€¢ Conversation<br/>â€¢ ConversationTurn<br/>â€¢ ConversationAnalysis<br/>â€¢ ToolInvocation<br/>â€¢ User<br/>â€¢ Memory<br/>â€¢ MemoryEmbedding<br/>â€¢ MemoryLink<br/>â€¢ ConversationMemory"]

        L2_Purpose["<b>Purpose:</b><br/>â€¢ Rich domain models<br/>â€¢ Business logic methods<br/>â€¢ Validation rules<br/>â€¢ Computed properties<br/>â€¢ Relationship management"]

        L2_Operations["<b>Operations:</b><br/>â€¢ Composite scoring<br/>â€¢ Memory decay calculations<br/>â€¢ Vector similarity search<br/>â€¢ Graph traversal<br/>â€¢ State transitions<br/>â€¢ Webhook processing"]
    end

    subgraph Layer1["ğŸ’¾ LAYER 1: DATABASE SCHEMA (Persistence Layer)"]
        direction TB
        L1_Tables["<b>SQLite Tables</b><br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/><b>Integration:</b><br/>â€¢ webhook_events<br/><br/><b>Conversation:</b><br/>â€¢ conversations<br/>â€¢ conversation_turns<br/>â€¢ conversation_analysis<br/>â€¢ tool_invocations<br/><br/><b>Memory:</b><br/>â€¢ users<br/>â€¢ memories<br/>â€¢ memory_embeddings<br/>â€¢ memory_links<br/>â€¢ conversation_memories"]

        L1_Purpose["<b>Purpose:</b><br/>â€¢ Normalized storage<br/>â€¢ Data integrity (FK constraints)<br/>â€¢ Efficient queries (indexes)<br/>â€¢ ACID transactions<br/>â€¢ Persistence"]

        L1_Features["<b>Features:</b><br/>â€¢ Foreign key cascades<br/>â€¢ Unique constraints<br/>â€¢ JSON columns<br/>â€¢ BLOB for embeddings<br/>â€¢ Composite indexes<br/>â€¢ WAL mode for concurrency"]
    end

    %% External to Layer 3
    EL -->|Webhook Requests| Layer3
    UI <-->|REST/GraphQL API| Layer3

    %% Layer 3 to Layer 2
    Layer3 -->|"<b>Request Flow â¬‡ï¸</b><br/>Parse & Validate<br/>DTOs (Request objects)"| Layer2
    Layer2 -->|"<b>Response Flow â¬†ï¸</b><br/>Serialize & Transform<br/>DTOs (Response objects)"| Layer3

    %% Layer 2 to Layer 1
    Layer2 -->|"<b>Write Operations â¬‡ï¸</b><br/>INSERT, UPDATE, DELETE<br/>ORM/SQL Queries"| Layer1
    Layer1 -->|"<b>Read Operations â¬†ï¸</b><br/>SELECT queries<br/>Raw result sets"| Layer2

    %% Styling
    classDef externalStyle fill:#fff9c4,stroke:#f57f17,stroke-width:3px,color:#000
    classDef layer3Style fill:#fff3e0,stroke:#e65100,stroke-width:3px
    classDef layer2Style fill:#f3e5f5,stroke:#4a148c,stroke-width:3px
    classDef layer1Style fill:#e1f5ff,stroke:#01579b,stroke-width:3px

    class External,EL,UI externalStyle
    class Layer3,L3_Models,L3_Purpose,L3_Transforms layer3Style
    class Layer2,L2_Models,L2_Purpose,L2_Operations layer2Style
    class Layer1,L1_Tables,L1_Purpose,L1_Features layer1Style
```
